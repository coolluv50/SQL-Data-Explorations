# SQL-Data-Explorations
# This project examines different case studies (corresponding files in folder) for data exploration. Respective codes printed after sub for each case study

-- Ensure master database is in use

          use master;


 --Creating a database for SQL Data Exploration projects
 
          Create Database [Data Exploration]
          go
	  
--selecting the Data Exploration Database

          Use [Data Exploration]
          go

# TRADES AND COMPANIES
-- Creating the two tables as specified in the Trades and Company case study

	  create table companies (
          name varchar (30) not null,
          country varchar (30) not null,
          unique (name)
          );

          create table trades (
          id integer not null,
          seller varchar (30) not null,
          buyer varchar (30) not null,
          value integer not null,
          unique (id)
          );

--TRADES AND COMPANIES- Inserting values into both tables to verify correctness of result generated by query later

          insert into companies values ('Alice s.p.', 'Wonderland');
          insert into companies values ('Y-zap', 'Wonderland');

          insert into companies values ('Absolute', 'Mathlands');

          insert into companies values ('Arcus t.g.', 'Mathlands');

          insert into companies values ('Lil Mermaid', 'Underwater Kingdom');

          insert into companies values ('None at all', 'Nothingland');

          insert into trades values (20121107, 'Lil Mermaid', 'Alice s.p.', 10);

          insert into trades values (20123112, 'Arcus t.g.', 'Y-zap', 30);

          insert into trades values (20120125, 'Alice s.p.', 'Arcus t.g.', 100);

          insert into trades values (20120216, 'Lil Mermaid', 'Absolute', 30);

          insert into trades values (20120217, 'Lil Mermaid', 'Absolute', 50);
	  
TRADES AND COMPANIES --query to explore dataset and generate required report for trades and companies
 
	select country, case when sum(exports) is null then 0 else sum(exports) end as exports,
	case when sum(imports) is null then 0 else sum(imports) end as imports
	from
	(select c.country, c.name, e.exports, i.imports
	from companies c
	left join								-- Left joining companies table to subquery e on name
			(select seller as name , sum(value) as exports
			from trades
			group by seller) e					--Subquery aggregating the exports by seller (company) aliased as e
	on c.name=e.name
	left join								--Left joining companies table on subquery i

			(select buyer as name , sum(value) as imports
			from trades
			group by buyer) i					--Subquery aggreagting the imports by seller aliased as i
	on c.name=i.name
	) final
	group by country
	order by country;
